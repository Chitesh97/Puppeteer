{"ast":null,"code":"/**\n * @license\n * Copyright 2023 Google Inc.\n * SPDX-License-Identifier: Apache-2.0\n */\nimport path from 'node:path';\nimport semver from 'semver';\nimport { getJSON } from '../httpUtil.js';\nimport { BrowserPlatform, ChromeReleaseChannel } from './types.js';\nfunction folder(platform) {\n  switch (platform) {\n    case BrowserPlatform.LINUX_ARM:\n    case BrowserPlatform.LINUX:\n      return 'linux64';\n    case BrowserPlatform.MAC_ARM:\n      return 'mac-arm64';\n    case BrowserPlatform.MAC:\n      return 'mac-x64';\n    case BrowserPlatform.WIN32:\n      return 'win32';\n    case BrowserPlatform.WIN64:\n      return 'win64';\n  }\n}\nexport function resolveDownloadUrl(platform, buildId, baseUrl = 'https://storage.googleapis.com/chrome-for-testing-public') {\n  return `${baseUrl}/${resolveDownloadPath(platform, buildId).join('/')}`;\n}\nexport function resolveDownloadPath(platform, buildId) {\n  return [buildId, folder(platform), `chrome-${folder(platform)}.zip`];\n}\nexport function relativeExecutablePath(platform, _buildId) {\n  switch (platform) {\n    case BrowserPlatform.MAC:\n    case BrowserPlatform.MAC_ARM:\n      return path.join('chrome-' + folder(platform), 'Google Chrome for Testing.app', 'Contents', 'MacOS', 'Google Chrome for Testing');\n    case BrowserPlatform.LINUX_ARM:\n    case BrowserPlatform.LINUX:\n      return path.join('chrome-linux64', 'chrome');\n    case BrowserPlatform.WIN32:\n    case BrowserPlatform.WIN64:\n      return path.join('chrome-' + folder(platform), 'chrome.exe');\n  }\n}\nexport async function getLastKnownGoodReleaseForChannel(channel) {\n  const data = await getJSON(new URL('https://googlechromelabs.github.io/chrome-for-testing/last-known-good-versions.json'));\n  for (const channel of Object.keys(data.channels)) {\n    data.channels[channel.toLowerCase()] = data.channels[channel];\n    delete data.channels[channel];\n  }\n  return data.channels[channel];\n}\nexport async function getLastKnownGoodReleaseForMilestone(milestone) {\n  const data = await getJSON(new URL('https://googlechromelabs.github.io/chrome-for-testing/latest-versions-per-milestone.json'));\n  return data.milestones[milestone];\n}\nexport async function getLastKnownGoodReleaseForBuild(\n/**\n * @example `112.0.23`,\n */\nbuildPrefix) {\n  const data = await getJSON(new URL('https://googlechromelabs.github.io/chrome-for-testing/latest-patch-versions-per-build.json'));\n  return data.builds[buildPrefix];\n}\nexport async function resolveBuildId(channel) {\n  if (Object.values(ChromeReleaseChannel).includes(channel)) {\n    return (await getLastKnownGoodReleaseForChannel(channel)).version;\n  }\n  if (channel.match(/^\\d+$/)) {\n    // Potentially a milestone.\n    return (await getLastKnownGoodReleaseForMilestone(channel))?.version;\n  }\n  if (channel.match(/^\\d+\\.\\d+\\.\\d+$/)) {\n    // Potentially a build prefix without the patch version.\n    return (await getLastKnownGoodReleaseForBuild(channel))?.version;\n  }\n  return;\n}\nexport function resolveSystemExecutablePath(platform, channel) {\n  switch (platform) {\n    case BrowserPlatform.WIN64:\n    case BrowserPlatform.WIN32:\n      switch (channel) {\n        case ChromeReleaseChannel.STABLE:\n          return `${process.env['PROGRAMFILES']}\\\\Google\\\\Chrome\\\\Application\\\\chrome.exe`;\n        case ChromeReleaseChannel.BETA:\n          return `${process.env['PROGRAMFILES']}\\\\Google\\\\Chrome Beta\\\\Application\\\\chrome.exe`;\n        case ChromeReleaseChannel.CANARY:\n          return `${process.env['PROGRAMFILES']}\\\\Google\\\\Chrome SxS\\\\Application\\\\chrome.exe`;\n        case ChromeReleaseChannel.DEV:\n          return `${process.env['PROGRAMFILES']}\\\\Google\\\\Chrome Dev\\\\Application\\\\chrome.exe`;\n      }\n    case BrowserPlatform.MAC_ARM:\n    case BrowserPlatform.MAC:\n      switch (channel) {\n        case ChromeReleaseChannel.STABLE:\n          return '/Applications/Google Chrome.app/Contents/MacOS/Google Chrome';\n        case ChromeReleaseChannel.BETA:\n          return '/Applications/Google Chrome Beta.app/Contents/MacOS/Google Chrome Beta';\n        case ChromeReleaseChannel.CANARY:\n          return '/Applications/Google Chrome Canary.app/Contents/MacOS/Google Chrome Canary';\n        case ChromeReleaseChannel.DEV:\n          return '/Applications/Google Chrome Dev.app/Contents/MacOS/Google Chrome Dev';\n      }\n    case BrowserPlatform.LINUX_ARM:\n    case BrowserPlatform.LINUX:\n      switch (channel) {\n        case ChromeReleaseChannel.STABLE:\n          return '/opt/google/chrome/chrome';\n        case ChromeReleaseChannel.BETA:\n          return '/opt/google/chrome-beta/chrome';\n        case ChromeReleaseChannel.CANARY:\n          return '/opt/google/chrome-canary/chrome';\n        case ChromeReleaseChannel.DEV:\n          return '/opt/google/chrome-unstable/chrome';\n      }\n  }\n}\nexport function compareVersions(a, b) {\n  if (!semver.valid(a)) {\n    throw new Error(`Version ${a} is not a valid semver version`);\n  }\n  if (!semver.valid(b)) {\n    throw new Error(`Version ${b} is not a valid semver version`);\n  }\n  if (semver.gt(a, b)) {\n    return 1;\n  } else if (semver.lt(a, b)) {\n    return -1;\n  } else {\n    return 0;\n  }\n}","map":{"version":3,"names":["path","semver","getJSON","BrowserPlatform","ChromeReleaseChannel","folder","platform","LINUX_ARM","LINUX","MAC_ARM","MAC","WIN32","WIN64","resolveDownloadUrl","buildId","baseUrl","resolveDownloadPath","join","relativeExecutablePath","_buildId","getLastKnownGoodReleaseForChannel","channel","data","URL","Object","keys","channels","toLowerCase","getLastKnownGoodReleaseForMilestone","milestone","milestones","getLastKnownGoodReleaseForBuild","buildPrefix","builds","resolveBuildId","values","includes","version","match","resolveSystemExecutablePath","STABLE","process","env","BETA","CANARY","DEV","compareVersions","a","b","valid","Error","gt","lt"],"sources":["/Users/goyac1/Desktop/Projects/puppeteer/node_modules/@puppeteer/browsers/src/browser-data/chrome.ts"],"sourcesContent":["/**\n * @license\n * Copyright 2023 Google Inc.\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport path from 'node:path';\n\nimport semver from 'semver';\n\nimport {getJSON} from '../httpUtil.js';\n\nimport {BrowserPlatform, ChromeReleaseChannel} from './types.js';\n\nfunction folder(platform: BrowserPlatform): string {\n  switch (platform) {\n    case BrowserPlatform.LINUX_ARM:\n    case BrowserPlatform.LINUX:\n      return 'linux64';\n    case BrowserPlatform.MAC_ARM:\n      return 'mac-arm64';\n    case BrowserPlatform.MAC:\n      return 'mac-x64';\n    case BrowserPlatform.WIN32:\n      return 'win32';\n    case BrowserPlatform.WIN64:\n      return 'win64';\n  }\n}\n\nexport function resolveDownloadUrl(\n  platform: BrowserPlatform,\n  buildId: string,\n  baseUrl = 'https://storage.googleapis.com/chrome-for-testing-public',\n): string {\n  return `${baseUrl}/${resolveDownloadPath(platform, buildId).join('/')}`;\n}\n\nexport function resolveDownloadPath(\n  platform: BrowserPlatform,\n  buildId: string,\n): string[] {\n  return [buildId, folder(platform), `chrome-${folder(platform)}.zip`];\n}\n\nexport function relativeExecutablePath(\n  platform: BrowserPlatform,\n  _buildId: string,\n): string {\n  switch (platform) {\n    case BrowserPlatform.MAC:\n    case BrowserPlatform.MAC_ARM:\n      return path.join(\n        'chrome-' + folder(platform),\n        'Google Chrome for Testing.app',\n        'Contents',\n        'MacOS',\n        'Google Chrome for Testing',\n      );\n    case BrowserPlatform.LINUX_ARM:\n    case BrowserPlatform.LINUX:\n      return path.join('chrome-linux64', 'chrome');\n    case BrowserPlatform.WIN32:\n    case BrowserPlatform.WIN64:\n      return path.join('chrome-' + folder(platform), 'chrome.exe');\n  }\n}\n\nexport async function getLastKnownGoodReleaseForChannel(\n  channel: ChromeReleaseChannel,\n): Promise<{version: string; revision: string}> {\n  const data = (await getJSON(\n    new URL(\n      'https://googlechromelabs.github.io/chrome-for-testing/last-known-good-versions.json',\n    ),\n  )) as {\n    channels: Record<string, {version: string}>;\n  };\n\n  for (const channel of Object.keys(data.channels)) {\n    data.channels[channel.toLowerCase()] = data.channels[channel]!;\n    delete data.channels[channel];\n  }\n\n  return (\n    data as {\n      channels: Record<\n        ChromeReleaseChannel,\n        {version: string; revision: string}\n      >;\n    }\n  ).channels[channel];\n}\n\nexport async function getLastKnownGoodReleaseForMilestone(\n  milestone: string,\n): Promise<{version: string; revision: string} | undefined> {\n  const data = (await getJSON(\n    new URL(\n      'https://googlechromelabs.github.io/chrome-for-testing/latest-versions-per-milestone.json',\n    ),\n  )) as {\n    milestones: Record<string, {version: string; revision: string}>;\n  };\n  return data.milestones[milestone] as\n    | {version: string; revision: string}\n    | undefined;\n}\n\nexport async function getLastKnownGoodReleaseForBuild(\n  /**\n   * @example `112.0.23`,\n   */\n  buildPrefix: string,\n): Promise<{version: string; revision: string} | undefined> {\n  const data = (await getJSON(\n    new URL(\n      'https://googlechromelabs.github.io/chrome-for-testing/latest-patch-versions-per-build.json',\n    ),\n  )) as {\n    builds: Record<string, {version: string; revision: string}>;\n  };\n  return data.builds[buildPrefix] as\n    | {version: string; revision: string}\n    | undefined;\n}\n\nexport async function resolveBuildId(\n  channel: ChromeReleaseChannel,\n): Promise<string>;\nexport async function resolveBuildId(\n  channel: string,\n): Promise<string | undefined>;\nexport async function resolveBuildId(\n  channel: ChromeReleaseChannel | string,\n): Promise<string | undefined> {\n  if (\n    Object.values(ChromeReleaseChannel).includes(\n      channel as ChromeReleaseChannel,\n    )\n  ) {\n    return (\n      await getLastKnownGoodReleaseForChannel(channel as ChromeReleaseChannel)\n    ).version;\n  }\n  if (channel.match(/^\\d+$/)) {\n    // Potentially a milestone.\n    return (await getLastKnownGoodReleaseForMilestone(channel))?.version;\n  }\n  if (channel.match(/^\\d+\\.\\d+\\.\\d+$/)) {\n    // Potentially a build prefix without the patch version.\n    return (await getLastKnownGoodReleaseForBuild(channel))?.version;\n  }\n  return;\n}\n\nexport function resolveSystemExecutablePath(\n  platform: BrowserPlatform,\n  channel: ChromeReleaseChannel,\n): string {\n  switch (platform) {\n    case BrowserPlatform.WIN64:\n    case BrowserPlatform.WIN32:\n      switch (channel) {\n        case ChromeReleaseChannel.STABLE:\n          return `${process.env['PROGRAMFILES']}\\\\Google\\\\Chrome\\\\Application\\\\chrome.exe`;\n        case ChromeReleaseChannel.BETA:\n          return `${process.env['PROGRAMFILES']}\\\\Google\\\\Chrome Beta\\\\Application\\\\chrome.exe`;\n        case ChromeReleaseChannel.CANARY:\n          return `${process.env['PROGRAMFILES']}\\\\Google\\\\Chrome SxS\\\\Application\\\\chrome.exe`;\n        case ChromeReleaseChannel.DEV:\n          return `${process.env['PROGRAMFILES']}\\\\Google\\\\Chrome Dev\\\\Application\\\\chrome.exe`;\n      }\n    case BrowserPlatform.MAC_ARM:\n    case BrowserPlatform.MAC:\n      switch (channel) {\n        case ChromeReleaseChannel.STABLE:\n          return '/Applications/Google Chrome.app/Contents/MacOS/Google Chrome';\n        case ChromeReleaseChannel.BETA:\n          return '/Applications/Google Chrome Beta.app/Contents/MacOS/Google Chrome Beta';\n        case ChromeReleaseChannel.CANARY:\n          return '/Applications/Google Chrome Canary.app/Contents/MacOS/Google Chrome Canary';\n        case ChromeReleaseChannel.DEV:\n          return '/Applications/Google Chrome Dev.app/Contents/MacOS/Google Chrome Dev';\n      }\n    case BrowserPlatform.LINUX_ARM:\n    case BrowserPlatform.LINUX:\n      switch (channel) {\n        case ChromeReleaseChannel.STABLE:\n          return '/opt/google/chrome/chrome';\n        case ChromeReleaseChannel.BETA:\n          return '/opt/google/chrome-beta/chrome';\n        case ChromeReleaseChannel.CANARY:\n          return '/opt/google/chrome-canary/chrome';\n        case ChromeReleaseChannel.DEV:\n          return '/opt/google/chrome-unstable/chrome';\n      }\n  }\n}\n\nexport function compareVersions(a: string, b: string): number {\n  if (!semver.valid(a)) {\n    throw new Error(`Version ${a} is not a valid semver version`);\n  }\n  if (!semver.valid(b)) {\n    throw new Error(`Version ${b} is not a valid semver version`);\n  }\n  if (semver.gt(a, b)) {\n    return 1;\n  } else if (semver.lt(a, b)) {\n    return -1;\n  } else {\n    return 0;\n  }\n}\n"],"mappings":"AAAA;;;;;AAMA,OAAOA,IAAI,MAAM,WAAW;AAE5B,OAAOC,MAAM,MAAM,QAAQ;AAE3B,SAAQC,OAAO,QAAO,gBAAgB;AAEtC,SAAQC,eAAe,EAAEC,oBAAoB,QAAO,YAAY;AAEhE,SAASC,MAAMA,CAACC,QAAyB;EACvC,QAAQA,QAAQ;IACd,KAAKH,eAAe,CAACI,SAAS;IAC9B,KAAKJ,eAAe,CAACK,KAAK;MACxB,OAAO,SAAS;IAClB,KAAKL,eAAe,CAACM,OAAO;MAC1B,OAAO,WAAW;IACpB,KAAKN,eAAe,CAACO,GAAG;MACtB,OAAO,SAAS;IAClB,KAAKP,eAAe,CAACQ,KAAK;MACxB,OAAO,OAAO;IAChB,KAAKR,eAAe,CAACS,KAAK;MACxB,OAAO,OAAO;EAClB;AACF;AAEA,OAAM,SAAUC,kBAAkBA,CAChCP,QAAyB,EACzBQ,OAAe,EACfC,OAAO,GAAG,0DAA0D;EAEpE,OAAO,GAAGA,OAAO,IAAIC,mBAAmB,CAACV,QAAQ,EAAEQ,OAAO,CAAC,CAACG,IAAI,CAAC,GAAG,CAAC,EAAE;AACzE;AAEA,OAAM,SAAUD,mBAAmBA,CACjCV,QAAyB,EACzBQ,OAAe;EAEf,OAAO,CAACA,OAAO,EAAET,MAAM,CAACC,QAAQ,CAAC,EAAE,UAAUD,MAAM,CAACC,QAAQ,CAAC,MAAM,CAAC;AACtE;AAEA,OAAM,SAAUY,sBAAsBA,CACpCZ,QAAyB,EACzBa,QAAgB;EAEhB,QAAQb,QAAQ;IACd,KAAKH,eAAe,CAACO,GAAG;IACxB,KAAKP,eAAe,CAACM,OAAO;MAC1B,OAAOT,IAAI,CAACiB,IAAI,CACd,SAAS,GAAGZ,MAAM,CAACC,QAAQ,CAAC,EAC5B,+BAA+B,EAC/B,UAAU,EACV,OAAO,EACP,2BAA2B,CAC5B;IACH,KAAKH,eAAe,CAACI,SAAS;IAC9B,KAAKJ,eAAe,CAACK,KAAK;MACxB,OAAOR,IAAI,CAACiB,IAAI,CAAC,gBAAgB,EAAE,QAAQ,CAAC;IAC9C,KAAKd,eAAe,CAACQ,KAAK;IAC1B,KAAKR,eAAe,CAACS,KAAK;MACxB,OAAOZ,IAAI,CAACiB,IAAI,CAAC,SAAS,GAAGZ,MAAM,CAACC,QAAQ,CAAC,EAAE,YAAY,CAAC;EAChE;AACF;AAEA,OAAO,eAAec,iCAAiCA,CACrDC,OAA6B;EAE7B,MAAMC,IAAI,GAAI,MAAMpB,OAAO,CACzB,IAAIqB,GAAG,CACL,qFAAqF,CACtF,CAGF;EAED,KAAK,MAAMF,OAAO,IAAIG,MAAM,CAACC,IAAI,CAACH,IAAI,CAACI,QAAQ,CAAC,EAAE;IAChDJ,IAAI,CAACI,QAAQ,CAACL,OAAO,CAACM,WAAW,EAAE,CAAC,GAAGL,IAAI,CAACI,QAAQ,CAACL,OAAO,CAAE;IAC9D,OAAOC,IAAI,CAACI,QAAQ,CAACL,OAAO,CAAC;EAC/B;EAEA,OACEC,IAMD,CAACI,QAAQ,CAACL,OAAO,CAAC;AACrB;AAEA,OAAO,eAAeO,mCAAmCA,CACvDC,SAAiB;EAEjB,MAAMP,IAAI,GAAI,MAAMpB,OAAO,CACzB,IAAIqB,GAAG,CACL,0FAA0F,CAC3F,CAGF;EACD,OAAOD,IAAI,CAACQ,UAAU,CAACD,SAAS,CAEnB;AACf;AAEA,OAAO,eAAeE,+BAA+BA;AACnD;;;AAGAC,WAAmB;EAEnB,MAAMV,IAAI,GAAI,MAAMpB,OAAO,CACzB,IAAIqB,GAAG,CACL,4FAA4F,CAC7F,CAGF;EACD,OAAOD,IAAI,CAACW,MAAM,CAACD,WAAW,CAEjB;AACf;AAQA,OAAO,eAAeE,cAAcA,CAClCb,OAAsC;EAEtC,IACEG,MAAM,CAACW,MAAM,CAAC/B,oBAAoB,CAAC,CAACgC,QAAQ,CAC1Cf,OAA+B,CAChC,EACD;IACA,OAAO,CACL,MAAMD,iCAAiC,CAACC,OAA+B,CAAC,EACxEgB,OAAO;EACX;EACA,IAAIhB,OAAO,CAACiB,KAAK,CAAC,OAAO,CAAC,EAAE;IAC1B;IACA,OAAO,CAAC,MAAMV,mCAAmC,CAACP,OAAO,CAAC,GAAGgB,OAAO;EACtE;EACA,IAAIhB,OAAO,CAACiB,KAAK,CAAC,iBAAiB,CAAC,EAAE;IACpC;IACA,OAAO,CAAC,MAAMP,+BAA+B,CAACV,OAAO,CAAC,GAAGgB,OAAO;EAClE;EACA;AACF;AAEA,OAAM,SAAUE,2BAA2BA,CACzCjC,QAAyB,EACzBe,OAA6B;EAE7B,QAAQf,QAAQ;IACd,KAAKH,eAAe,CAACS,KAAK;IAC1B,KAAKT,eAAe,CAACQ,KAAK;MACxB,QAAQU,OAAO;QACb,KAAKjB,oBAAoB,CAACoC,MAAM;UAC9B,OAAO,GAAGC,OAAO,CAACC,GAAG,CAAC,cAAc,CAAC,2CAA2C;QAClF,KAAKtC,oBAAoB,CAACuC,IAAI;UAC5B,OAAO,GAAGF,OAAO,CAACC,GAAG,CAAC,cAAc,CAAC,gDAAgD;QACvF,KAAKtC,oBAAoB,CAACwC,MAAM;UAC9B,OAAO,GAAGH,OAAO,CAACC,GAAG,CAAC,cAAc,CAAC,+CAA+C;QACtF,KAAKtC,oBAAoB,CAACyC,GAAG;UAC3B,OAAO,GAAGJ,OAAO,CAACC,GAAG,CAAC,cAAc,CAAC,+CAA+C;MACxF;IACF,KAAKvC,eAAe,CAACM,OAAO;IAC5B,KAAKN,eAAe,CAACO,GAAG;MACtB,QAAQW,OAAO;QACb,KAAKjB,oBAAoB,CAACoC,MAAM;UAC9B,OAAO,8DAA8D;QACvE,KAAKpC,oBAAoB,CAACuC,IAAI;UAC5B,OAAO,wEAAwE;QACjF,KAAKvC,oBAAoB,CAACwC,MAAM;UAC9B,OAAO,4EAA4E;QACrF,KAAKxC,oBAAoB,CAACyC,GAAG;UAC3B,OAAO,sEAAsE;MACjF;IACF,KAAK1C,eAAe,CAACI,SAAS;IAC9B,KAAKJ,eAAe,CAACK,KAAK;MACxB,QAAQa,OAAO;QACb,KAAKjB,oBAAoB,CAACoC,MAAM;UAC9B,OAAO,2BAA2B;QACpC,KAAKpC,oBAAoB,CAACuC,IAAI;UAC5B,OAAO,gCAAgC;QACzC,KAAKvC,oBAAoB,CAACwC,MAAM;UAC9B,OAAO,kCAAkC;QAC3C,KAAKxC,oBAAoB,CAACyC,GAAG;UAC3B,OAAO,oCAAoC;MAC/C;EACJ;AACF;AAEA,OAAM,SAAUC,eAAeA,CAACC,CAAS,EAAEC,CAAS;EAClD,IAAI,CAAC/C,MAAM,CAACgD,KAAK,CAACF,CAAC,CAAC,EAAE;IACpB,MAAM,IAAIG,KAAK,CAAC,WAAWH,CAAC,gCAAgC,CAAC;EAC/D;EACA,IAAI,CAAC9C,MAAM,CAACgD,KAAK,CAACD,CAAC,CAAC,EAAE;IACpB,MAAM,IAAIE,KAAK,CAAC,WAAWF,CAAC,gCAAgC,CAAC;EAC/D;EACA,IAAI/C,MAAM,CAACkD,EAAE,CAACJ,CAAC,EAAEC,CAAC,CAAC,EAAE;IACnB,OAAO,CAAC;EACV,CAAC,MAAM,IAAI/C,MAAM,CAACmD,EAAE,CAACL,CAAC,EAAEC,CAAC,CAAC,EAAE;IAC1B,OAAO,CAAC,CAAC;EACX,CAAC,MAAM;IACL,OAAO,CAAC;EACV;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}